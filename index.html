<!DOCTYPE html>
<html lang="fi">
<head>
<meta charset="UTF-8">
<title>J√§√§tel√∂kioski</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f2f6fa;
  max-width: 900px;
  margin: auto;
  padding: 20px;
}

h1, h2 {
  color: #2c3e50;
}

.box {
  background: white;
  padding: 15px;
  margin-bottom: 15px;
  border-radius: 8px;
  box-shadow: 0 0 6px rgba(0,0,0,0.1);
}

label {
  display: block;
  margin-top: 10px;
}

button {
  margin-top: 15px;
  padding: 10px 20px;
  font-size: 16px;
}

select {
  margin-top: 10px;
  padding: 5px;
}

.progress {
  background: #ddd;
  height: 20px;
  border-radius: 10px;
  overflow: hidden;
}

.progress-bar {
  height: 100%;
}
</style>
</head>

<body>

<h1>üç¶ J√§√§tel√∂kioski</h1>

<div class="box" id="setupBox">
  <h2>Aloitus</h2>
  <p>Valitse kioskin sijainti. Sijainti vaikuttaa myyntiin eri s√§√§olosuhteissa.</p>

  <label>
    Sijainti:
    <select id="locationSelect">
      <option value="0">Puisto</option>
      <option value="1">Kauppakeskus</option>
      <option value="2">Uimaranta</option>
    </select>
  </label>

  <button id="startGame">Aloita peli</button>
</div>

<div class="box" id="gameBox" style="display:none;">
  <h2 id="weekTitle">Viikko 1 / 12</h2>

  <p><b>Sijainti:</b> <span id="locationText"></span></p>

  <p><b>S√§√§:</b> <span id="weatherText"></span><br>
  Ennuste: <span id="forecastText"></span></p>

  <p><b>Jaksaminen:</b> <span id="energyValue"></span>/100</p>
  <div class="progress">
    <div class="progress-bar" id="energyBar"></div>
  </div>
  <p id="energyText"></p>
</div>

<div class="box" id="decisionBox" style="display:none;">
  <h2>P√§√§t√∂kset</h2>

  <label>
    Hinta (‚Ç¨ / annos):
    <input type="number" id="price" value="3.5" step="0.1">
  </label>

  <label>
    Tilattavat pakkaukset (5 l):
    <input type="number" id="packages" value="8">
  </label>

  <button id="playButton">Pelaa viikko</button>
</div>

<div class="box">
  <h2>Tulos</h2>
  <div id="result"></div>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {

  let week = 1;
  const maxWeeks = 12;
  let cash = -500;
  let energy = 80;
  let location;

  const portionsPerPackage = 50;
  const packagePrice = 30;
  const fixedCost = 600;

  const locations = [
    { name: "Puisto", multiplier: [0.6,0.8,1.0,1.2,1.3,1.2] },
    { name: "Kauppakeskus", multiplier: [1.1,1.1,1.0,0.9,0.8,0.7] },
    { name: "Uimaranta", multiplier: [0.4,0.5,0.8,1.3,1.5,1.7] }
  ];

  const weatherTexts = [
    "Kylm√§√§ ja rankkasadetta",
    "Hyvin sateista",
    "Vaihtelevaa",
    "L√§mmin kes√§s√§√§",
    "Eritt√§in l√§mmin kes√§s√§√§",
    "Helle"
  ];

  function updateEnergyUI() {
    const bar = document.getElementById("energyBar");
    bar.style.width = energy + "%";

    let text = "";
    let color = "green";

    if (energy >= 70) {
      text = "üòä Hyv√§ vire ‚Äì jaksat palvella asiakkaita tehokkaasti.";
      color = "green";
    } else if (energy >= 40) {
      text = "üòê V√§sytt√§√§ hieman ‚Äì keskittyminen herpaantuu.";
      color = "yellow";
    } else if (energy >= 20) {
      text = "üòì Olet v√§synyt ‚Äì myynti ja palvelu k√§rsiv√§t.";
      color = "orange";
    } else if (energy > 0) {
      text = "ü•µ Uupumus ‚Äì kioski ei toimi t√§ydell√§ teholla.";
      color = "red";
    } else {
      text = "üö´ T√§ysin uupunut ‚Äì kioski on k√§yt√§nn√∂ss√§ kiinni.";
      color = "black";
    }

    bar.style.background = color;
    document.getElementById("energyValue").innerText = energy;
    document.getElementById("energyText").innerText = text;
  }

  function playWeek() {
    if (week > maxWeeks) return;

    const price = Number(document.getElementById("price").value);
    const orderedPackages = Number(document.getElementById("packages").value);

    const forecast = Math.floor(Math.random() * 6);
    let weather = forecast + Math.floor(Math.random() * 5 - 2);
    weather = Math.max(0, Math.min(5, weather));

    document.getElementById("weatherText").innerText = weatherTexts[weather];
    document.getElementById("forecastText").innerText = weatherTexts[forecast];

    let totalDemand = 800 + weather * 400;
    totalDemand *= location.multiplier[weather];

    let demand = totalDemand / 3;
    demand *= (4 / price);

    if (energy < 60) demand *= 0.8;
    if (energy < 30) demand *= 0.5;
    if (energy < 10) demand *= 0.25;
    if (energy <= 0) demand = 0;

    const maxSales = orderedPackages * portionsPerPackage;
    const sold = Math.min(Math.floor(demand), maxSales);

    const revenue = sold * price;
    const costs = orderedPackages * packagePrice + fixedCost;
    const profit = revenue - costs;
    cash += profit;

    let fatigue = 5;
    if (sold > 300) fatigue += 5;
    if (weather <= 1) fatigue += 5;
    if (sold > 500) fatigue += 5;
    energy = Math.max(0, energy - fatigue);

    document.getElementById("result").innerHTML = `
      <p>Viikko ${week}: Myyty <b>${sold}</b> annosta</p>
      <p>Viikon tulos: <b>${profit.toFixed(0)} ‚Ç¨</b></p>
      <p>Kassa yhteens√§: ${cash.toFixed(0)} ‚Ç¨</p>
    `;

    updateEnergyUI();

    if (week === maxWeeks) {
      document.getElementById("playButton").disabled = true;
      document.getElementById("result").innerHTML += `
        <hr>
        <p><b>Kes√§ty√∂jakso p√§√§ttyi.</b></p>
        <p>Lopullinen tulos: ${cash.toFixed(0)} ‚Ç¨</p>
      `;
    }

    week++;
    document.getElementById("weekTitle").innerText = `Viikko ${week} / 12`;
  }

  document.getElementById("startGame").addEventListener("click", () => {
    const index = Number(document.getElementById("locationSelect").value);
    location = locations[index];

    document.getElementById("locationText").innerText = location.name;
    document.getElementById("setupBox").style.display = "none";
    document.getElementById("gameBox").style.display = "block";
    document.getElementById("decisionBox").style.display = "block";

    updateEnergyUI();
  });

  document.getElementById("playButton").addEventListener("click", playWeek);

});
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="fi">
<head>
<meta charset="UTF-8">
<title>J√§√§tel√∂kioski</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f2f6fa;
  max-width: 900px;
  margin: auto;
  padding: 20px;
}

h1, h2 {
  color: #2c3e50;
}

.box {
  background: white;
  padding: 15px;
  margin-bottom: 15px;
  border-radius: 8px;
  box-shadow: 0 0 6px rgba(0,0,0,0.1);
}

label {
  display: block;
  margin-top: 10px;
}

button {
  margin-top: 15px;
  padding: 10px 20px;
  font-size: 16px;
}

.progress {
  background: #ddd;
  height: 20px;
  border-radius: 10px;
  overflow: hidden;
}

.progress-bar {
  height: 100%;
  width: 80%;
  background: green;
}
</style>
</head>

<body>

<h1>üç¶ J√§√§tel√∂kioski</h1>

<div class="box">
<h2 id="weekTitle">Viikko 1</h2>

<p><b>Sijainti:</b> <span id="locationText"></span></p>
<p><b>S√§√§:</b> <span id="weatherText"></span><br>
Ennuste: <span id="forecastText"></span></p>

<p><b>Jaksaminen:</b> <span id="energyValue"></span>/100</p>
<div class="progress">
  <div class="progress-bar" id="energyBar"></div>
</div>
<p id="energyText"></p>
</div>

<div class="box">
<h2>P√§√§t√∂kset</h2>

<label>
Hinta (‚Ç¨ / annos):
<input type="number" id="price" value="3.5" step="0.1">
</label>

<label>
Tilattavat pakkaukset (5 l):
<input type="number" id="packages" value="8">
</label>

<button onclick="playWeek()">Pelaa viikko</button>
</div>

<div class="box">
<h2>Viikon tulos</h2>
<div id="result"></div>
</div>

<script>
let week = 1;
let cash = -500;
let energy = 80;

const portionsPerPackage = 50;
const packagePrice = 30;
const fixedCost = 600;

const locations = [
  { name: "Puisto", multiplier: [0.6,0.8,1.0,1.2,1.3,1.2] },
  { name: "Kauppakeskus", multiplier: [1.1,1.1,1.0,0.9,0.8,0.7] },
  { name: "Uimaranta", multiplier: [0.4,0.5,0.8,1.3,1.5,1.7] }
];

const location = locations[Math.floor(Math.random() * locations.length)];
document.getElementById("locationText").innerText = location.name;

const weatherTexts = [
  "Kylm√§√§ ja rankkasadetta",
  "Hyvin sateista",
  "Vaihtelevaa",
  "L√§mmin kes√§s√§√§",
  "Eritt√§in l√§mmin kes√§s√§√§",
  "Helle"
];

function updateEnergyUI() {
  document.getElementById("energyValue").innerText = energy;
  const bar = document.getElementById("energyBar");
  bar.style.width = energy + "%";

  let text = "";
  if (energy >= 70) {
    bar.style.background = "green";
    text = "üòä Hyv√§ vire ‚Äì jaksat palvella asiakkaita tehokkaasti.";
  } else if (energy >= 40) {
    bar.style.background = "yellow";
    text = "üòê V√§sytt√§√§ hieman ‚Äì keskittyminen herpaantuu.";
  } else if (energy >= 20) {
    bar.style.background = "orange";
    text = "üòì Olet v√§synyt ‚Äì myynti ja palvelu k√§rsiv√§t.";
  } else if (energy > 0) {
    bar.style.background = "red";
    text = "ü•µ Uupumus ‚Äì kioski ei toimi t√§ydell√§ teholla.";
  } else {
    bar.style.background = "black";
    text = "üö´ T√§ysin uupunut ‚Äì kioski on k√§yt√§nn√∂ss√§ kiinni.";
  }

  document.getElementById("energyText").innerText = text;
}

function playWeek() {
  const price = Number(document.getElementById("price").value);
  const orderedPackages = Number(document.getElementById("packages").value);

  const forecast = Math.floor(Math.random() * 6);
  let weather = forecast + Math.floor(Math.random() * 5 - 2);
  weather = Math.max(0, Math.min(5, weather));

  document.getElementById("weatherText").innerText = weatherTexts[weather];
  document.getElementById("forecastText").innerText = weatherTexts[forecast];

  // Kokonaiskysynt√§ kaupungissa
  let totalDemand = 800 + weather * 400;

  // Sijainnin vaikutus
  totalDemand *= location.multiplier[weather];

  // Kilpailijat (2 kpl)
  const competitors = 2;
  const share = 1 / (competitors + 1);
  let demand = totalDemand * share;

  // Hinnan vaikutus
  demand *= (4 / price);

  // Jaksamisen vaikutus
  if (energy < 60) demand *= 0.8;
  if (energy < 30) demand *= 0.5;
  if (energy < 10) demand *= 0.25;
  if (energy <= 0) demand = 0;

  const maxSales = orderedPackages * portionsPerPackage;
  const sold = Math.min(Math.floor(demand), maxSales);

  const revenue = sold * price;
  const costs = orderedPackages * packagePrice + fixedCost;
  const profit = revenue - costs;
  cash += profit;

  // Jaksaminen
  let fatigue = 5;
  if (sold > 300) fatigue += 5;
  if (weather <= 1) fatigue += 5;
  if (sold > 500) fatigue += 5;
  energy = Math.max(0, energy - fatigue);

  document.getElementById("result").innerHTML = `
    <p>Myyty: <b>${sold}</b> annosta</p>
    <p>Tulot: ${revenue.toFixed(0)} ‚Ç¨</p>
    <p>Kulut: ${costs.toFixed(0)} ‚Ç¨</p>
    <p><b>Viikon tulos: ${profit.toFixed(0)} ‚Ç¨</b></p>
    <p>Kassa yhteens√§: ${cash.toFixed(0)} ‚Ç¨</p>
  `;

  week++;
  document.getElementById("weekTitle").innerText = "Viikko " + week;
  updateEnergyUI();
}

updateEnergyUI();
</script>

</body>
</html>
